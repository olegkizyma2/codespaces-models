#!/usr/bin/env bash
# AI Chat Global Command
# –ó–∞–ø—É—Å–∫–∞—î –ø—Ä–æ—Å—Ç–∏–π —á–∞—Ç –∑ 24 AI –º–æ–¥–µ–ª—è–º–∏ –∑ –±—É–¥—å-—è–∫–æ—ó –ø–∞–ø–∫–∏ –≤ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ
#
# –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è:
#   sudo cp chat /usr/local/bin/chat
#   sudo chmod +x /usr/local/bin/chat
#
# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
#   chat               # –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —á–∞—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3010
#   chat PORT=3011     # –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–∞ —ñ–Ω—à–æ–º—É –ø–æ—Ä—Ç—É
#   chat stop          # –∑—É–ø–∏–Ω–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
#   chat status        # –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å
#   chat logs          # –ø–æ–∫–∞–∑–∞—Ç–∏ –ª–æ–≥–∏
#   chat test          # —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ API

# –®–ª—è—Ö –¥–æ –ø—Ä–æ–µ–∫—Ç—É —á–∞—Ç—É
CHAT_PROJECT_DIR="/Users/dev/Documents/NIMDA/codespaces-models"

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É
if [ ! -d "$CHAT_PROJECT_DIR" ]; then
    echo "‚ùå –ü—Ä–æ–µ–∫—Ç —á–∞—Ç—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤: $CHAT_PROJECT_DIR"
    echo "üí° –û–Ω–æ–≤—ñ—Ç—å —à–ª—è—Ö –≤ —Ñ–∞–π–ª—ñ /usr/local/bin/chat"
    exit 1
fi

if [ ! -f "$CHAT_PROJECT_DIR/Makefile" ]; then
    echo "‚ùå Makefile –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤: $CHAT_PROJECT_DIR"
    exit 1
fi

# –ö–æ–ª—å–æ—Ä–∏
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m'

# –ü–æ–∫–∞–∑–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∑–∞–ø—É—Å–∫
echo -e "${BLUE}ü§ñ AI Chat - –ó–∞–ø—É—Å–∫ –∑ $(pwd)${NC}"
echo -e "${BLUE}üìÅ –ü—Ä–æ–µ–∫—Ç: $CHAT_PROJECT_DIR${NC}"

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É
cd "$CHAT_PROJECT_DIR" || {
    echo "‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –ø—Ä–æ–µ–∫—Ç—É"
    exit 1
}

# –ü–µ—Ä–µ–¥–∞—Ç–∏ –≤—Å—ñ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –¥–æ make
if [ $# -eq 0 ]; then
    # –ë–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ - –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —á–∞—Ç
    make chat
else
    # –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥
    case "$1" in
        "stop"|"restart"|"status"|"logs"|"test"|"clean"|"help")
            make "$@"
            ;;
        "PORT="*)
            # –ü–µ—Ä–µ–¥–∞—á–∞ –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è
            make chat "$@"
            ;;
        *)
            # –ü–µ—Ä–µ–¥–∞—á–∞ —è–∫ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è –∞–±–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
            make chat "$@"
            ;;
    esac
fi

# –ü–æ–∫–∞–∑–∞—Ç–∏ —à–≤–∏–¥–∫—ñ –∫–æ–º–∞–Ω–¥–∏ –ø—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É
if [ $# -eq 0 ] || [ "$1" = "chat" ]; then
    echo ""
    echo -e "${YELLOW}üí° –®–≤–∏–¥–∫—ñ –∫–æ–º–∞–Ω–¥–∏:${NC}"
    echo "  chat stop     - –∑—É–ø–∏–Ω–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä"
    echo "  chat status   - –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å"
    echo "  chat logs     - –ø–æ–∫–∞–∑–∞—Ç–∏ –ª–æ–≥–∏"
    echo "  chat test     - —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ API"
    echo "  chat help     - –ø–æ–≤–Ω–∞ –¥–æ–≤—ñ–¥–∫–∞"
fi
